// default processing pipeline for HTML
const pipeline = require("../../index.js");
const { before, after } = require('./default.js');
const winston = require("winston");

const defaultlogger = winston.createLogger({
  level: "debug",
  format: winston.format.simple(),
  transports: [
    new winston.transports.Console(),
    new winston.transports.File({ filename: "html.pipeline.log" })
  ]
});

module.exports.pipe = function(cont, params, logger = defaultlogger) {
    logger.log("debug", "Constructing HTML Pipeline");
    const pipe = pipeline()
        .pre(before)
        .pre(require("../html/fetch-markdown.js"))
        .once(cont)
        .post(after);

    return pipe;
};
